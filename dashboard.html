<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="assets/favicon/logos-s-favicon.png">

    <!-- =================== FONTS AWESOME 6.4.0 -->
    <link rel="stylesheet" type="text/css"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- ================== BOOTSTRAP 4.1 ========= -->
    <link href="assets/css/bootstrap-grid.css">

    <!-- ================== style.css =============== -->
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">

    <!-- ================== responsive =================== -->
    <link rel="stylesheet" type="text/css" href="assets/css/responsive.css">
    <title>Trang Chủ</title>
    <style>
        .edit-remove {}
    </style>
</head>


<body>

    <!-- ======================== LOADING ============================= -->
    <!-- <div class="loading">
        <div class="overlay-l">
            <div class="lds-roller">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
    </div> -->


    <!-- =========================== HEADER ===================================== -->
    <header>

    </header>

    <!-- ===================================== Search Start ========================== -->


    <!-- ===================================== Search End ========================== -->


    <!-- =========================== BANNER Start ================================== -->

    <!-- =========================== BANNER End ================================== -->





    <main>
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="page-cart">
                        <div class="table">
                            <table id="table">
                                <!-- table head -->
                                <tr class="tr-title">
                                    <th>ID</th>
                                    <th>Ảnh</th>
                                    <th>Tên sản phẩm</th>
                                    <th>Giá</th>
                                    <th></th>
                                </tr>



                            </table>
                        </div>

                    </div>

                </div>
            </div>
        </div>
    </main>



    <footer>
    </footer>
    <script type="module">

        // import DataProducts from "./assets/js/modules/data.js"
        // console.log(DataProducts);
        function renderCart(data) {
            let table = document.querySelector("#table");
            data = data.map((elm, index) => {
                let images = elm.pd_image.split(/[/]/);
                return `    
                <tr class="tr-product">
                                    <td>
                                        <h4>${elm.id}</h4>
                                    </td>
                                    <td>
                                        <div>
                                            <img src="assets/image/${images[0]}" alt="image">
                                        </div>
                                    </td>
                                    <td>
                                        <div>
                                            <h3>${elm.name}</h3>
                                        </div>
                                    </td>
                                    <td>
                                        <div>
                                            <strong>${elm.price}</strong>
                                            VNĐ
                                        </div>
                                    </td>
                                    <td class="edit-remove">
                                        
                                        <div data-remove="${elm.id}" class="delete-cart" data-id="${elm.id}">
                                            <i class="fa-regular fa-trash-can"></i>
                                        </div>
                                    </td>
                                </tr>

                `
            }).join(" ");
            table.innerHTML += data;
        }
        // renderCart(DataProducts);
        // window.addEventListener('load', getData)

        async function getData() {
            let url = "http://localhost:5050/SP";
            let res = await fetch(url, {
                method: "GET"
            })
            let data = await res.json();
            console.log(data);
            return (data);
        }
        getData()
            .then(res => renderCart(res))
            .then(res => removeCart())
        async function removeCart() {
            let btnRemove = document.querySelectorAll(".delete-cart");
            console.log(btnRemove)
            btnRemove.forEach(elm => {
                elm.addEventListener("click", async function (e) {
                    let req = await fetch(`http://localhost:5050/SP/${this.dataset.id}`, {
                        method: 'DELETE',
                    })
                        .then(res => res.text()) // or res.json()
                        .then(res => console.log(res))
                })
            })
        }
        removeCart();
    </script>

    <!-- <script src="assets/js/renderH_F.js"></script>
    <script src="assets/js/custom.js"></script>
    <script type="module">

    </script>
    <script src="assets/js/loading.js"></script>
    <script type="module" src="assets/js/mn-cart.js"></script> -->
</body>

</html>